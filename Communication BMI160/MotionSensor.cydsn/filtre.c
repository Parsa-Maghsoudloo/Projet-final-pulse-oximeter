/* ========================================
 *
 * Copyright YOUR COMPANY, THE YEAR
 * All Rights Reserved
 * UNPUBLISHED, LICENSED SOFTWARE.
 *
 * CONFIDENTIAL AND PROPRIETARY INFORMATION
 * WHICH IS THE PROPERTY OF your company.
 *
 * ========================================
*/

/* [] END OF FILE */

#include "project.h"
#include "FreeRTOS.h"
#include "task.h"
#include "queue.h"
#include "motion_task.h"
#include "uart_debug.h" 
#include <arm_math.h>
#include <core_cm4.h>
#if defined(SEMIHOSTING)
#include <stdio.h>
#endif    
    
    

float vecteur_IR[] = {238721.0, 239155.0, 238744.0, 239946.0, 238753.0, 240032.0, 239073.0, 240717.0, 239376.0, 241553.0, 239723.0, 241443.0, 240320.0, 242428.0, 240665.0, 242439.0, 241301.0, 242787.0, 241730.0, 243056.0, 242274.0, 243182.0, 242969.0, 243474.0, 243649.0, 243638.0, 244164.0, 243931.0, 245217.0, 244056.0, 245372.0, 244485.0, 246177.0, 244705.0, 246772.0, 244982.0, 246498.0, 245156.0, 247115.0, 245122.0, 246715.0, 245267.0, 246383.0, 245141.0, 246134.0, 244973.0, 245734.0, 245155.0, 245275.0, 245084.0, 244738.0, 244906.0, 244265.0, 245172.0, 243826.0, 244723.0, 243675.0, 245035.0, 243392.0, 245140.0, 243377.0, 244754.0, 243441.0, 245404.0, 243380.0, 244962.0, 243519.0, 244950.0, 243603.0, 244759.0, 243712.0, 244600.0, 244078.0, 244445.0, 244267.0, 244188.0, 244488.0, 244160.0, 245149.0, 243993.0, 244859.0, 244004.0, 245656.0, 244027.0, 245825.0, 244192.0, 245653.0, 244424.0, 246520.0, 244540.0, 246187.0, 244915.0, 246260.0, 245059.0, 246352.0, 245219.0, 246261.0, 245773.0, 246315.0, 246047.0, 246115.0, 246405.0, 246055.0, 247026.0, 246001.0, 246743.0, 245720.0, 247153.0, 245170.0, 246351.0, 244154.0, 244895.0, 242823.0, 244111.0, 241468.0, 242277.0, 240255.0, 240963.0, 238998.0, 239779.0, 238116.0, 238756.0, 237821.0, 237988.0, 237388.0, 237325.0, 237387.0, 237060.0, 237758.0, 236694.0, 237469.0, 236831.0, 238465.0, 236829.0, 238617.0, 237274.0, 238865.0, 237621.0, 239828.0, 238000.0, 239751.0, 238540.0, 240183.0, 238852.0, 240393.0, 239259.0, 240655.0, 240086.0, 240869.0, 240591.0, 240973.0, 241303.0, 241243.0, 242084.0, 241383.0, 242293.0, 241740.0, 243451.0, 241968.0, 243705.0, 242414.0, 243999.0, 242757.0, 244910.0, 243072.0, 244625.0, 243329.0, 244890.0, 243375.0, 244716.0, 243538.0, 244517.0, 243709.0, 244229.0, 243627.0, 243768.0, 243682.0, 243381.0, 243817.0, 242899.0, 243465.0, 242540.0, 243946.0, 242165.0, 243484.0, 242096.0, 243392.0, 241963.0, 243947.0, 241848.0, 243349.0, 241932.0, 243492.0, 241889.0, 243228.0, 241975.0, 243115.0, 242334.0, 242987.0, 242368.0, 242761.0, 242832.0, 242624.0, 243298.0, 242514.0, 243154.0, 242490.0, 243953.0, 242375.0, 243817.0, 242552.0, 244008.0, 242662.0, 244809.0, 242785.0, 244365.0, 243041.0, 244782.0, 243169.0, 244625.0, 243481.0, 244592.0, 243787.0, 244622.0, 243950.0, 244461.0, 244446.0, 244415.0, 244937.0, 244299.0, 244920.0, 244332.0, 245758.0, 244213.0, 245482.0, 244289.0, 245755.0, 244347.0, 246305.0, 244113.0, 245279.0, 243463.0, 244648.0, 242226.0, 242944.0, 240960.0, 241436.0, 239884.0, 240012.0, 238607.0, 238566.0, 237895.0, 237520.0, 237372.0, 236447.0, 236692.0, 235889.0, 237037.0, 235429.0, 236523.0, 235321.0, 236743.0, 235326.0, 237459.0, 235505.0, 237041.0, 235811.0, 237733.0, 236035.0, 237711.0, 236494.0, 237861.0, 237079.0, 237968.0, 237327.0, 238119.0, 238057.0, 238266.0, 238777.0, 238426.0, 239021.0, 238654.0, 240135.0, 238754.0, 240155.0, 239260.0, 240857.0, 239593.0, 241872.0, 240044.0, 241566.0, 240462.0, 242403.0, 240781.0, 242324.0, 241029.0, 242399.0, 241365.0, 242310.0, 241491.0, 242069.0, 241824.0, 241904.0, 241955.0, 241442.0, 241739.0, 241210.0, 242225.0, 240692.0, 241675.0, 240477.0, 241930.0, 240299.0, 242165.0, 240129.0, 241411.0, 240028.0, 241833.0, 239923.0, 241379.0, 239942.0, 241151.0, 239964.0, 240892.0, 240015.0, 240716.0, 240330.0, 240529.0, 240512.0, 240281.0, 240707.0, 240223.0, 241371.0, 240023.0, 241029.0, 240138.0, 241643.0, 240080.0, 242059.0, 240278.0, 241732.0, 240458.0, 242473.0, 240628.0, 242169.0, 240867.0, 242123.0, 241086.0, 242106.0, 241239.0, 241987.0, 241741.0, 241981.0, 242014.0, 241794.0, 242246.0, 241837.0, 242993.0, 241731.0, 242744.0, 241866.0, 243488.0, 241876.0, 243738.0, 242044.0, 243448.0, 242214.0, 244235.0, 242363.0, 243890.0, 242504.0, 243815.0, 242453.0, 243316.0, 241882.0, 242161.0, 241101.0, 240758.0, 239961.0, 239115.0, 238699.0, 237619.0, 237927.0, 236164.0, 236528.0, 235277.0, 236357.0, 234335.0, 235808.0, 233830.0, 235037.0, 233616.0, 235484.0, 233440.0, 234940.0, 233627.0, 234943.0, 233668.0, 234937.0, 233943.0, 234969.0, 234593.0, 235061.0, 235020.0, 235165.0, 235486.0, 235316.0, 236361.0, 235417.0, 236396.0, 235823.0, 237502.0, 236062.0, 237831.0, 236520.0, 238089.0, 236978.0, 239202.0, 237356.0, 239102.0, 237992.0, 239409.0, 238232.0, 239617.0, 238603.0, 239666.0, 239274.0, 239788.0, 239601.0, 239740.0, 239957.0, 239689.0, 240500.0, 239468.0, 240240.0, 239493.0, 240874.0, 239281.0, 240596.0, 239067.0, 240359.0, 239016.0, 240871.0, 238786.0, 240165.0, 238636.0, 239773.0, 238260.0, 239309.0, 238023.0, 239019.0, 238246.0, 238674.0, 238185.0, 238436.0, 238514.0, 238285.0, 238870.0, 237952.0, 238638.0, 238040.0, 239474.0, 237871.0, 239335.0, 238016.0, 239454.0, 238094.0, 240164.0, 238188.0, 239727.0, 238434.0, 239941.0, 238520.0, 239806.0, 238671.0, 239748.0, 239104.0, 239609.0, 239150.0, 239472.0, 239652.0, 239482.0, 240074.0, 239304.0, 239952.0, 239415.0, 240846.0, 239252.0, 240747.0, 239509.0, 241020.0, 239672.0, 241763.0, 239912.0, 241351.0, 240119.0, 241686.0, 240047.0, 241401.0, 240156.0, 241247.0, 240527.0, 241108.0, 240554.0, 240967.0, 241013.0, 240716.0, 241201.0, 240207.0, 240409.0, 239254.0, 240099.0, 237859.0, 238506.0, 236647.0, 237323.0, 235333.0, 236722.0, 234176.0, 235062.0, 233278.0, 234462.0, 232510.0, 233567.0, 232020.0, 232950.0, 231988.0, 232584.0, 231845.0, 232270.0, 232132.0, 232168.0, 232533.0, 231974.0, 232511.0, 232147.0, 233626.0, 232264.0, 233554.0, 232623.0, 234151.0, 233033.0, 235176.0, 233389.0, 234958.0, 233967.0, 235735.0, 234249.0, 235824.0, 234776.0, 236080.0, 235345.0, 236317.0, 235756.0, 236422.0, 236490.0, 236627.0, 237070.0, 236679.0, 237317.0, 236875.0, 238276.0, 236878.0, 238125.0, 237091.0, 238593.0, 237190.0, 239229.0, 237183.0, 238523.0, 237214.0, 238887.0, 237039.0, 238316.0, 236899.0, 237986.0, 236836.0, 237562.0, 236637.0, 237156.0, 236759.0, 236747.0, 236812.0, 236344.0, 236722.0, 236114.0, 237184.0, 235768.0, 236770.0, 235760.0, 237162.0, 235662.0, 237681.0, 235759.0, 237131.0, 235894.0, 237727.0, 235965.0, 237359.0, 236111.0, 237345.0, 236234.0, 237240.0, 236357.0, 237052.0, 236864.0, 237038.0, 237150.0, 236880.0, 237241.0, 236797.0, 237952.0, 236607.0, 237595.0, 236769.0, 238330.0, 236776.0, 238759.0, 236954.0, 238354.0, 237185.0, 239095.0, 237331.0, 238771.0, 237541.0, 238742.0, 237629.0, 238672.0, 237742.0, 238603.0, 238295.0, 238509.0, 238477.0, 238296.0, 238703.0, 238308.0, 239405.0, 238046.0, 239020.0, 238117.0, 239607.0, 237876.0, 239392.0, 237328.0, 238118.0, 236319.0, 237652.0, 235076.0, 235890.0, 233903.0, 234450.0, 232591.0, 233018.0, 231490.0, 231796.0, 230902.0, 230858.0, 230331.0, 229971.0, 229976.0, 229416.0, 230248.0, 228938.0, 229689.0, 228963.0, 230359.0, 228842.0, 230499.0, 229063.0, 230427.0, 229386.0, 231419.0, 229637.0, 231283.0, 230136.0, 231525.0, 230329.0, 231660.0, 230832.0, 231833.0, 231480.0, 232013.0, 231918.0, 232097.0, 232473.0, 232293.0, 233310.0, 232373.0, 233291.0, 232793.0, 234342.0, 232936.0, 234663.0, 233289.0, 234779.0, 233594.0, 235671.0, 233856.0, 235448.0, 234197.0, 235498.0, 234192.0, 235293.0, 234219.0, 235039.0, 234371.0, 234731.0, 234286.0, 234247.0, 234277.0, 233910.0, 234504.0, 233299.0, 233955.0, 233165.0, 234519.0, 232729.0, 234148.0, 232742.0, 233928.0, 232651.0, 234580.0, 232567.0, 234022.0, 232680.0, 234047.0, 232611.0, 233876.0, 232732.0, 233665.0, 233083.0, 233559.0, 233159.0, 233409.0, 233532.0, 233357.0, 234055.0, 233171.0, 233805.0, 233260.0, 234744.0, 233120.0, 234590.0, 233316.0, 234755.0, 233478.0, 235443.0, 233514.0, 234986.0, 233773.0, 235220.0, 233807.0, 235072.0, 233930.0, 235108.0, 234426.0, 235018.0, 234463.0, 234874.0, 234931.0, 234764.0, 235338.0, 234656.0, 235241.0, 234736.0, 236190.0, 234656.0, 235957.0, 234808.0, 236149.0, 234801.0, 236893.0, 234983.0, 236428.0, 235171.0, 236655.0, 235012.0, 236155.0, 234670.0, 235313.0, 233954.0, 233944.0, 232553.0, 232292.0, 231622.0, 230847.0, 230575.0, 229256.0, 229118.0, 228041.0, 228952.0, 226957.0, 227760.0, 226263.0, 227346.0, 225799.0, 227599.0, 225519.0, 226812.0, 225550.0, 227099.0, 225481.0, 226803.0, 225639.0, 226795.0, 226046.0, 226844.0, 226206.0, 226816.0, 226874.0, 226905.0, 227384.0, 226955.0, 227503.0, 227143.0, 228613.0, 227221.0, 228486.0, 227611.0, 229057.0, 227836.0, 229980.0, 228245.0, 229692.0, 228706.0, 230514.0, 229026.0, 230510.0, 229443.0, 230671.0, 229839.0, 230730.0, 230029.0, 230733.0, 230611.0, 230656.0, 230878.0, 230435.0, 230853.0, 230283.0, 231442.0, 229909.0, 230854.0, 229812.0, 231159.0, 229535.0, 231471.0, 229349.0, 230561.0, 229312.0, 230973.0, 229073.0, 230392.0, 229113.0, 230169.0, 229049.0, 229836.0, 228928.0, 229548.0, 229271.0, 229329.0, 229455.0, 229059.0, 229421.0, 228958.0, 230085.0, 228692.0, 229796.0, 228829.0, 230358.0, 228842.0, 230764.0, 228990.0, 230280.0, 229144.0, 231015.0, 229241.0, 230723.0, 229501.0, 230759.0, 229665.0, 230681.0, 229872.0, 230569.0, 230284.0, 230490.0, 230431.0, 230258.0, 230587.0, 230215.0, 231260.0, 230071.0, 230972.0, 230158.0, 231765.0, 230192.0, 232046.0, 230381.0, 231663.0, 230608.0, 232329.0, 230688.0, 232444.0, 230930.0, 232159.0, 231037.0, 232058.0, 231125.0, 231948.0, 231630.0, 231951.0, 231762.0, 231688.0, 231991.0, 231588.0, 232607.0, 231260.0, 231971.0, 230925.0, 232046.0, 229914.0, 231039.0, 228830.0, 229394.0, 227577.0, 228691.0, 226135.0, 226963.0, 225096.0, 225680.0, 223910.0, 224524.0, 223037.0, 223583.0, 222798.0, 222804.0, 222265.0, 222177.0, 222261.0, 221808.0, 222623.0, 221444.0, 222162.0, 221548.0, 223048.0, 221471.0, 223136.0, 221741.0, 223114.0, 222095.0, 224055.0, 222327.0, 223850.0, 222796.0, 224080.0, 223024.0, 224298.0, 223374.0, 224427.0, 224031.0, 224485.0, 224337.0, 224570.0, 224861.0, 224708.0, 225612.0, 224737.0, 225506.0, 225063.0, 226745.0, 225141.0, 226694.0, 225434.0, 226855.0, 225722.0, 227716.0, 225815.0, 227305.0, 225967.0, 227289.0, 225913.0, 227076.0, 225827.0, 226735.0, 226015.0, 226368.0, 225869.0, 225982.0, 225980.0, 225579.0, 226167.0, 225227.0, 225746.0, 225062.0, 226469.0, 224744.0, 226049.0, 224719.0, 226033.0, 224713.0, 226587.0, 224709.0, 226095.0, 224878.0, 226253.0, 224833.0, 226133.0, 225001.0, 226024.0, 225312.0, 225907.0, 225423.0, 225795.0, 225877.0, 225718.0, 226317.0, 225600.0, 226134.0, 225633.0, 227146.0, 225564.0, 226819.0, 225743.0, 227075.0, 225836.0, 227885.0, 225970.0, 227352.0, 226263.0, 227758.0, 226213.0, 227572.0, 226378.0, 227535.0, 226767.0, 227451.0, 226834.0, 227281.0, 227356.0, 227249.0, 227770.0, 227075.0, 227702.0, 227195.0, 228675.0, 227139.0, 228350.0, 227193.0, 228601.0, 227408.0, 229479.0, 227525.0, 228876.0, 227811.0, 229377.0, 227798.0, 229174.0, 227985.0, 229049.0, 228199.0, 228744.0, 227763.0, 227942.0, 227303.0, 226708.0, 226427.0, 225155.0, 224923.0, 223719.0, 224422.0, 222194.0, 222694.0, 221048.0, 221960.0, 220075.0, 221718.0, 219386.0, 220384.0, 218941.0, 220428.0, 218549.0, 219764.0, 218432.0, 219479.0, 218526.0, 219368.0, 218562.0, 219189.0, 219100.0, 219168.0, 219479.0, 219095.0, 219715.0, 219260.0, 220641.0, 219263.0, 220478.0, 219675.0, 221142.0, 219879.0, 222087.0, 220265.0, 221748.0, 220695.0, 222541.0, 221011.0, 222478.0, 221406.0, 222693.0, 221802.0, 222820.0, 222104.0, 222924.0, 222803.0, 223071.0, 223190.0, 223008.0, 223475.0, 223017.0, 224287.0, 222850.0, 223815.0, 222993.0, 224381.0, 222865.0, 224609.0, 222807.0, 223952.0, 222712.0, 224456.0, 222567.0, 223893.0, 222520.0, 223616.0, 222429.0, 223335.0, 222380.0, 223054.0, 222604.0, 222775.0, 222755.0, 222404.0, 222742.0, 222340.0, 223377.0, 222072.0, 222964.0, 222197.0, 223726.0, 222157.0, 223926.0, 222379.0, 223649.0, 222595.0, 224543.0, 222629.0, 224160.0, 222907.0, 224159.0, 223135.0, 224176.0, 223208.0, 224112.0, 223792.0, 224110.0, 224009.0, 223969.0, 224289.0, 224013.0, 224946.0, 223847.0, 224658.0, 223996.0, 225603.0, 223979.0, 225685.0, 224201.0, 225527.0, 224370.0, 226265.0, 224445.0, 225929.0, 224722.0, 225993.0, 224781.0, 225864.0, 224883.0, 225826.0, 225494.0, 225840.0, 225629.0, 225658.0, 225931.0, 225669.0, 226546.0, 225460.0, 226281.0, 225648.0, 227230.0, 225672.0, 227174.0, 225856.0, 227145.0, 226031.0, 227967.0, 226078.0, 227419.0, 226090.0, 227174.0, 225553.0, 226239.0, 224533.0, 224846.0, 223662.0, 223337.0, 222315.0, 221730.0, 221195.0, 220382.0, 220476.0, 219033.0, 219113.0, 218086.0, 219314.0, 217319.0, 218460.0, 216984.0, 218123.0, 216755.0, 218586.0, 216625.0, 217999.0, 216828.0, 218201.0, 216866.0, 218143.0, 217097.0, 218240.0, 217686.0, 218234.0, 217945.0, 218320.0, 218563.0, 218498.0, 219263.0, 218545.0, 219285.0, 218829.0, 220437.0, 219011.0, 220413.0, 219432.0, 220848.0, 219763.0, 221863.0, 220167.0, 221614.0, 220592.0, 222200.0, 220848.0, 222162.0, 221167.0, 222322.0, 221639.0, 222290.0, 221755.0, 222183.0, 222314.0, 222137.0, 222629.0, 221926.0, 222340.0, 221713.0, 223136.0, 221402.0, 222425.0, 221327.0, 222523.0, 221224.0, 223114.0, 221074.0, 222315.0, 221063.0, 222604.0, 220868.0, 222139.0, 220979.0, 222017.0, 221160.0, 221809.0, 221019.0, 221571.0, 221489.0, 221383.0, 221832.0, 221221.0, 221665.0, 221275.0, 222677.0, 221108.0, 222241.0, 221270.0, 222715.0, 221362.0, 223498.0, 221646.0, 222941.0, 221865.0, 223551.0, 221978.0, 223338.0, 222253.0, 223389.0, 222559.0, 223335.0, 222676.0, 223259.0, 223231.0, 223253.0, 223521.0, 223024.0, 223386.0, 222822.0, 224101.0, 222658.0, 223765.0, 222881.0, 224321.0, 223040.0, 225071.0, 223215.0, 224567.0, 223580.0, 225256.0, 223605.0, 225043.0, 223883.0, 225039.0, 224190.0, 225052.0, 224220.0, 224939.0, 224694.0, 224819.0, 225120.0, 224757.0, 225173.0, 224745.0, 225991.0, 224566.0, 225578.0, 224729.0, 226278.0, 224852.0, 226744.0, 224964.0, 226229.0, 225053.0, 226780.0, 224738.0, 225766.0, 224117.0, 224733.0, 223015.0, 223289.0, 221776.0, 221836.0, 220942.0, 220361.0, 219886.0, 219114.0, 218947.0, 218059.0, 218718.0, 217137.0, 217694.0, 216687.0, 217999.0, 216292.0, 217991.0, 216298.0, 217489.0, 216406.0, 218298.0, 216515.0, 218024.0, 216922.0, 218212.0, 217246.0, 218300.0, 217505.0, 218435.0, 218306.0, 218547.0, 218767.0, 218779.0, 219149.0, 219011.0, 220182.0, 219089.0, 220059.0, 219520.0, 221216.0, 219847.0, 221662.0, 220217.0, 221630.0, 220671.0, 222693.0, 221069.0, 222613.0, 221480.0, 222855.0, 221772.0, 222889.0, 221901.0, 222888.0, 222538.0, 222744.0, 222659.0, 222504.0, 222746.0, 222324.0, 223056.0, 221830.0, 222435.0, 221697.0, 223099.0, 221356.0, 222799.0, 221272.0, 222449.0, 221242.0, 223033.0, 221103.0, 222522.0, 221234.0, 222345.0, 221044.0, 222096.0, 221102.0, 221944.0, 221458.0, 221773.0, 221469.0, 221631.0, 221847.0, 221586.0, 222304.0, 221402.0, 222088.0, 221576.0, 223146.0, 221450.0, 222945.0, 221648.0, 223072.0, 221865.0, 223876.0, 222045.0, 223474.0, 222359.0, 223665.0, 222413.0, 223620.0, 222614.0, 223671.0, 223141.0, 223595.0, 223243.0, 223618.0, 223796.0, 223523.0, 224214.0, 223368.0, 223949.0, 223460.0, 225044.0, 223416.0, 224827.0, 223626.0, 224994.0, 223826.0, 225795.0, 223904.0, 225375.0, 224196.0, 225663.0, 224259.0, 225447.0, 224250.0, 225162.0, 224451.0, 225101.0, 224570.0, 225055.0, 225261.0, 225048.0, 225609.0, 224980.0, 225532.0, 225116.0, 226625.0, 224989.0, 226318.0, 225189.0, 226562.0, 225272.0, 227212.0, 225009.0, 225903.0, 224319.0, 225276.0, 223089.0, 223619.0, 221836.0, 222175.0, 220766.0, 220770.0, 219548.0, 219462.0, 218984.0, 218400.0, 218359.0, 217476.0, 217669.0, 216918.0, 218159.0, 216451.0, 217467.0, 216435.0, 217766.0, 216508.0, 218530.0, 216718.0, 218070.0, 217001.0, 218740.0, 217239.0, 218743.0, 217695.0, 218925.0, 218250.0, 219054.0, 218508.0, 219197.0, 219272.0, 219399.0, 219911.0, 219472.0, 220084.0, 219770.0, 221242.0, 219898.0, 221099.0, 220306.0, 221765.0, 220654.0, 222709.0, 220963.0, 222435.0, 221430.0, 223259.0, 221776.0, 223168.0, 222117.0, 223235.0, 222420.0, 223235.0, 222423.0, 223102.0, 222913.0, 222862.0, 223024.0, 222490.0, 222841.0, 222315.0, 223404.0, 221782.0, 222730.0, 221752.0, 223082.0, 221565.0, 223492.0, 221493.0, 222696.0, 221491.0, 223248.0, 221425.0, 222725.0, 221523.0, 222557.0, 221629.0, 222447.0, 221549.0, 222292.0, 222128.0, 222171.0, 222304.0, 222007.0, 222472.0, 222029.0, 223222.0, 221893.0, 222871.0, 222132.0, 223674.0, 222249.0, 224156.0, 222435.0, 223749.0, 222729.0, 224631.0, 222813.0, 224321.0, 223186.0, 224381.0, 223371.0, 224288.0, 223472.0, 224199.0, 224073.0, 224248.0, 224164.0, 224073.0, 224465.0, 224031.0, 225151.0, 223827.0, 224853.0, 224127.0, 225709.0, 224128.0, 225894.0, 224413.0, 225614.0, 224575.0, 226463.0, 224760.0, 226205.0, 225034.0, 226235.0, 225187.0, 226219.0, 225247.0, 226175.0, 225825.0, 226125.0, 225992.0, 225966.0, 226254.0, 225932.0, 226913.0, 225807.0, 226611.0, 225955.0, 227446.0, 225727.0, 227012.0, 225140.0, 225933.0, 224150.0, 225439.0, 222912.0, 223614.0, 221740.0, 222262.0, 220482.0, 221000.0, 219298.0, 219783.0, 218923.0, 218840.0, 218198.0, 217961.0, 217967.0, 217528.0, 218163.0, 217032.0, 217680.0, 217011.0, 218621.0, 216940.0, 218468.0, 217224.0, 218483.0, 217452.0, 219637.0, 217848.0, 219402.0, 218312.0, 219618.0, 218539.0, 219886.0, 218845.0, 220031.0, 219629.0, 220154.0, 219964.0, 220346.0, 220713.0, 220578.0, 221441.0, 220674.0, 221424.0, 221021.0, 222676.0, 221206.0, 222726.0, 221638.0, 223039.0, 222005.0, 224142.0, 222374.0, 223906.0, 222818.0, 224205.0, 222916.0, 224066.0, 223018.0, 223966.0, 223314.0, 223749.0, 223176.0, 223421.0, 223429.0, 223050.0, 223571.0, 222645.0, 223076.0, 222443.0, 223808.0, 222079.0, 223241.0, 221987.0, 223300.0, 221877.0, 223799.0, 221866.0, 223271.0, 221995.0, 223345.0, 221904.0, 223133.0, 222033.0, 223059.0, 222364.0, 222955.0, 222314.0, 222767.0, 222915.0, 222706.0, 223234.0, 222531.0, 223122.0, 222651.0, 224211.0, 222600.0, 223832.0, 222837.0, 224212.0, 222937.0, 224988.0, 223146.0, 224562.0, 223458.0, 225086.0, 223524.0, 224920.0, 223778.0, 224885.0, 224087.0, 224856.0, 224157.0, 224775.0, 224786.0, 224744.0, 225150.0, 224496.0, 225079.0, 224602.0, 226082.0, 224507.0, 225630.0, 224729.0, 226129.0, 224831.0, 226900.0, 225049.0, 226314.0, 225287.0, 226942.0, 225343.0, 226712.0, 225590.0, 226708.0, 225910.0, 226665.0, 225977.0, 226541.0, 226506.0, 226455.0, 226739.0, 226259.0, 226765.0, 226153.0, 227376.0, 225570.0, 226189.0, 224713.0, 225482.0, 223385.0, 224720.0, 222107.0, 222672.0, 220935.0, 222017.0, 219711.0, 220500.0, 218867.0, 219521.0, 218201.0, 218683.0, 217546.0, 217975.0, 217727.0, 217513.0, 217578.0, 217103.0, 217450.0, 216977.0, 218289.0, 216815.0, 217890.0, 217108.0, 218618.0, 217191.0, 219327.0, 217628.0, 219078.0, 218060.0, 219930.0, 218373.0, 219927.0, 218893.0, 220164.0, 219319.0, 220375.0, 219660.0, 220510.0, 220456.0, 220706.0, 220903.0, 220772.0, 221251.0, 221039.0, 222318.0, 221092.0, 222113.0, 221488.0, 223153.0, 221743.0, 223677.0, 222071.0, 223448.0, 222381.0, 224323.0, 222496.0, 223960.0, 222752.0, 223867.0, 222689.0, 223674.0, 222668.0, 223297.0, 222913.0, 222968.0, 222794.0, 222524.0, 222720.0, 222227.0, 223159.0, 221762.0, 222570.0, 221752.0, 223236.0, 221475.0, 223203.0, 221496.0, 222748.0, 221647.0, 223512.0, 221567.0, 222645.0, 221822.0, 223037.0, 221925.0, 222900.0, 222009.0, 222842.0, 222483.0, 222808.0, 222672.0, 222644.0, 222854.0, 222597.0, 223608.0, 222504.0, 223308.0, 222697.0, 224297.0, 222729.0, 224513.0, 222871.0, 224230.0, 223159.0, 225139.0, 223346.0, 224759.0, 223609.0, 224786.0, 223558.0, 224763.0, 223771.0, 224738.0, 224278.0, 224662.0, 224390.0, 224611.0, 224822.0, 224551.0, 225492.0, 224397.0, 225192.0, 224596.0, 226263.0, 224612.0, 226120.0, 224859.0, 226223.0, 225131.0, 227127.0, 225207.0, 226729.0, 225557.0, 226889.0, 225650.0, 226795.0, 225768.0, 226825.0, 226326.0, 226714.0, 226318.0, 226472.0, 226461.0, 225818.0, 225968.0, 224541.0, 224413.0, 223132.0, 223985.0, 221628.0, 222366.0, 220501.0, 221185.0, 219464.0, 220966.0, 218613.0, 219600.0, 218070.0, 219148.0, 217509.0, 218510.0, 217251.0, 218181.0, 217480.0, 217948.0, 217341.0, 217747.0, 217911.0, 217684.0, 218421.0, 217733.0, 218415.0, 217972.0, 219703.0, 218067.0, 219529.0, 218486.0, 220081.0, 218968.0, 221076.0, 219354.0, 220902.0, 219850.0, 221557.0, 220242.0, 221609.0, 220612.0, 221873.0};
float vecteur_RED[] = {426247.0, 428157.0, 426378.0, 428049.0, 426829.0, 428188.0, 427264.0, 428400.0, 427626.0, 428474.0, 428422.0, 428770.0, 429037.0, 428886.0, 429434.0, 429222.0, 430502.0, 429387.0, 430643.0, 429833.0, 431624.0, 430201.0, 432343.0, 430730.0, 432415.0, 431215.0, 433406.0, 431760.0, 433510.0, 432376.0, 433898.0, 432872.0, 434120.0, 433314.0, 434245.0, 433816.0, 434183.0, 434248.0, 433962.0, 434274.0, 433798.0, 434791.0, 433439.0, 434313.0, 433311.0, 434670.0, 432848.0, 434574.0, 432638.0, 433919.0, 432424.0, 434122.0, 433413.0, 433399.0, 431853.0, 433010.0, 431632.0, 432644.0, 431464.0, 432189.0, 431658.0, 431963.0, 431828.0, 431760.0, 431883.0, 431512.0, 432426.0, 431216.0, 432198.0, 431348.0, 432844.0, 431252.0, 432986.0, 431320.0, 432709.0, 431444.0, 433407.0, 431494.0, 433160.0, 431763.0, 433099.0, 431871.0, 433076.0, 431953.0, 432986.0, 432562.0, 432874.0, 432836.0, 432803.0, 433072.0, 432795.0, 433718.0, 432777.0, 433721.0, 432958.0, 434609.0, 432971.0, 434773.0, 433319.0, 434830.0, 433540.0, 435644.0, 433695.0, 435350.0, 433981.0, 435352.0, 433889.0, 435015.0, 433436.0, 433910.0, 432582.0, 432193.0, 431114.0, 430281.0, 429709.0, 428655.0, 428599.0, 426817.0, 427091.0, 425669.0, 426657.0, 424609.0, 425781.0, 423916.0, 425113.0, 423461.0, 425482.0, 423373.0, 424961.0, 423563.0, 424972.0, 423778.0, 425100.0, 424003.0, 425244.0, 424647.0, 425409.0, 425119.0, 425461.0, 425701.0, 425716.0, 426642.0, 425826.0, 426825.0, 426312.0, 428061.0, 426516.0, 428263.0, 427044.0, 428743.0, 427475.0, 429883.0, 428062.0, 429805.0, 428637.0, 430190.0, 428950.0, 430504.0, 429446.0, 430750.0, 430204.0, 430926.0, 430557.0, 430974.0, 431192.0, 431050.0, 431797.0, 430985.0, 431580.0, 430941.0, 432427.0, 430627.0, 432205.0, 430689.0, 431960.0, 430496.0, 432351.0, 430232.0, 431560.0, 430074.0, 431392.0, 429671.0, 430905.0, 429482.0, 430433.0, 429522.0, 430034.0, 429341.0, 429607.0, 429561.0, 429371.0, 429828.0, 428924.0, 429597.0, 428915.0, 430311.0, 428748.0, 430141.0, 428901.0, 430401.0, 429001.0, 431089.0, 429066.0, 430662.0, 429377.0, 430854.0, 429331.0, 430794.0, 429619.0, 430666.0, 429912.0, 430662.0, 430009.0, 430522.0, 430447.0, 430413.0, 430953.0, 430341.0, 430947.0, 430451.0, 431899.0, 430426.0, 431823.0, 430624.0, 432144.0, 430766.0, 432867.0, 431045.0, 432473.0, 431290.0, 432963.0, 431340.0, 432771.0, 431534.0, 432589.0, 431788.0, 432512.0, 431773.0, 432149.0, 431954.0, 431542.0, 431425.0, 430103.0, 429920.0, 428502.0, 429066.0, 426740.0, 427202.0, 425351.0, 426090.0, 424040.0, 425540.0, 422941.0, 423883.0, 422270.0, 423649.0, 421659.0, 422935.0, 421486.0, 422410.0, 421465.0, 422306.0, 421540.0, 422128.0, 422009.0, 422134.0, 422529.0, 422234.0, 422772.0, 422385.0, 423859.0, 422443.0, 423746.0, 422877.0, 424518.0, 423212.0, 425519.0, 423629.0, 425237.0, 424230.0, 426105.0, 424507.0, 426156.0, 424964.0, 426376.0, 425574.0, 426685.0, 426007.0, 426845.0, 426749.0, 427060.0, 427362.0, 427100.0, 427691.0, 427294.0, 428590.0, 427233.0, 428430.0, 427415.0, 428973.0, 427486.0, 429432.0, 427473.0, 428736.0, 427373.0, 429113.0, 427027.0, 428449.0, 426978.0, 427973.0, 426768.0, 427571.0, 426569.0, 427077.0, 426594.0, 426673.0, 426729.0, 426256.0, 426508.0, 426022.0, 426954.0, 425595.0, 426535.0, 425476.0, 427018.0, 425431.0, 427321.0, 425474.0, 426862.0, 425561.0, 427466.0, 425606.0, 427100.0, 425853.0, 427053.0, 425969.0, 427069.0, 426050.0, 426804.0, 426615.0, 426788.0, 426910.0, 426658.0, 427047.0, 426555.0, 427691.0, 426460.0, 427526.0, 426643.0, 428230.0, 426693.0, 428641.0, 426931.0, 428362.0, 427145.0, 429176.0, 427388.0, 428906.0, 427601.0, 429001.0, 427821.0, 428993.0, 427879.0, 428825.0, 428376.0, 428642.0, 428649.0, 428496.0, 428797.0, 428420.0, 429421.0, 428140.0, 429022.0, 427925.0, 428980.0, 426750.0, 427808.0, 425401.0, 425962.0, 424027.0, 425141.0, 422399.0, 423334.0, 421309.0, 421920.0, 420215.0, 420789.0, 419323.0, 419850.0, 419013.0, 419097.0, 418824.0, 418627.0, 418758.0, 418339.0, 419200.0, 418091.0, 419060.0, 418422.0, 419992.0, 418440.0, 420203.0, 418803.0, 420403.0, 419337.0, 421515.0, 419723.0, 421439.0, 420293.0, 421788.0, 420699.0, 422013.0, 421145.0, 422339.0, 422029.0, 422606.0, 422430.0, 422758.0, 423098.0, 422972.0, 423979.0, 423097.0, 424036.0, 423460.0, 425148.0, 423588.0, 425332.0, 424004.0, 425432.0, 424291.0, 426318.0, 424353.0, 425992.0, 424601.0, 426021.0, 424536.0, 425730.0, 424548.0, 425419.0, 424706.0, 424985.0, 424499.0, 424507.0, 424444.0, 424113.0, 424555.0, 423307.0, 423652.0, 422591.0, 423951.0, 422146.0, 423504.0, 422091.0, 423473.0, 422146.0, 424141.0, 422139.0, 423639.0, 422336.0, 423706.0, 422380.0, 423670.0, 422441.0, 423535.0, 422909.0, 423411.0, 422984.0, 423289.0, 423360.0, 423243.0, 423828.0, 422986.0, 423699.0, 423083.0, 424601.0, 423035.0, 424410.0, 423211.0, 424640.0, 423334.0, 425432.0, 423571.0, 425067.0, 423869.0, 425390.0, 423890.0, 425216.0, 424146.0, 425283.0, 424573.0, 425282.0, 424752.0, 425169.0, 425258.0, 425118.0, 425776.0, 424880.0, 425401.0, 424698.0, 425913.0, 424236.0, 425592.0, 424404.0, 425861.0, 424549.0, 426582.0, 424498.0, 425966.0, 424379.0, 425572.0, 423454.0, 424228.0, 422157.0, 422512.0, 421021.0, 420897.0, 419499.0, 419219.0, 418531.0, 417831.0, 417785.0, 416609.0, 416632.0, 415735.0, 416802.0, 415036.0, 416158.0, 414874.0, 416115.0, 414802.0, 416856.0, 414925.0, 416294.0, 415245.0, 416893.0, 415517.0, 416955.0, 415879.0, 417099.0, 416356.0, 417361.0, 416889.0, 417574.0, 417640.0, 417814.0, 418338.0, 417921.0, 418597.0, 418251.0, 419755.0, 418436.0, 419724.0, 418823.0, 420403.0, 419168.0, 421440.0, 419608.0, 421187.0, 420065.0, 422006.0, 420356.0, 421976.0, 420762.0, 421976.0, 421124.0, 421966.0, 421234.0, 421843.0, 421616.0, 421630.0, 421747.0, 421183.0, 421432.0, 420872.0, 421877.0, 420308.0, 421288.0, 420111.0, 421468.0, 419868.0, 421646.0, 419618.0, 420932.0, 419543.0, 421280.0, 419451.0, 420817.0, 419518.0, 420550.0, 419502.0, 420441.0, 419524.0, 420146.0, 419955.0, 420032.0, 420262.0, 419817.0, 420260.0, 419783.0, 421002.0, 419578.0, 420573.0, 419713.0, 421203.0, 419666.0, 421675.0, 419947.0, 421242.0, 420042.0, 421969.0, 420136.0, 421684.0, 420322.0, 421489.0, 420501.0, 421486.0, 420631.0, 421397.0, 421207.0, 421384.0, 421371.0, 421143.0, 421545.0, 421173.0, 422255.0, 420997.0, 421874.0, 421085.0, 422621.0, 421069.0, 422934.0, 421186.0, 422539.0, 421414.0, 423280.0, 421392.0, 422999.0, 421674.0, 422840.0, 421702.0, 422704.0, 421522.0, 422153.0, 421380.0, 420931.0, 420202.0, 419376.0, 418836.0, 417688.0, 417939.0, 415872.0, 416055.0, 414704.0, 415500.0, 413421.0, 414590.0, 412452.0, 413461.0, 411919.0, 413572.0, 411606.0, 412849.0, 411510.0, 412637.0, 411367.0, 412444.0, 411481.0, 412334.0, 412001.0, 412423.0, 412379.0, 412422.0, 412759.0, 412636.0, 413657.0, 412673.0, 413631.0, 413165.0, 414773.0, 413327.0, 415039.0, 413750.0, 415215.0, 414206.0, 416306.0, 414539.0, 416206.0, 415143.0, 416588.0, 415375.0, 416787.0, 415755.0, 416804.0, 416527.0, 416994.0, 416844.0, 417046.0, 417307.0, 417022.0, 417882.0, 416915.0, 417583.0, 416906.0, 418330.0, 416610.0, 418040.0, 416521.0, 417651.0, 416276.0, 418040.0, 416023.0, 417316.0, 415958.0, 417029.0, 415608.0, 416601.0, 415402.0, 416166.0, 415519.0, 415782.0, 415457.0, 415518.0, 415521.0, 415199.0, 415956.0, 414934.0, 415557.0, 414975.0, 416428.0, 414884.0, 416182.0, 414888.0, 416310.0, 415035.0, 417042.0, 415164.0, 416637.0, 415341.0, 416783.0, 415396.0, 416694.0, 415619.0, 416668.0, 415907.0, 416565.0, 415999.0, 416298.0, 416387.0, 416216.0, 416814.0, 416089.0, 416624.0, 416130.0, 417602.0, 416057.0, 417396.0, 416169.0, 417560.0, 416301.0, 418362.0, 416434.0, 417845.0, 416741.0, 418243.0, 416775.0, 418147.0, 416919.0, 418121.0, 417266.0, 417948.0, 417350.0, 417819.0, 417776.0, 417631.0, 418052.0, 417358.0, 417758.0, 417043.0, 418149.0, 416030.0, 416693.0, 414849.0, 415467.0, 413359.0, 414601.0, 411893.0, 412531.0, 410607.0, 411526.0, 409282.0, 410014.0, 408349.0, 408939.0, 407697.0, 408197.0, 407247.0, 407494.0, 407260.0, 407150.0, 407510.0, 406770.0, 407304.0, 406771.0, 408183.0, 406678.0, 407994.0, 406980.0, 408399.0, 407254.0, 409343.0, 407521.0, 408980.0, 408005.0, 409796.0, 408291.0, 409711.0, 408674.0, 409918.0, 409227.0, 410142.0, 409446.0, 410086.0, 410162.0, 410286.0, 410745.0, 410345.0, 410897.0, 410630.0, 412012.0, 410715.0, 411925.0, 411060.0, 412522.0, 411192.0, 413302.0, 411375.0, 412693.0, 411499.0, 413199.0, 411472.0, 412677.0, 411325.0, 412371.0, 411255.0, 411919.0, 410891.0, 411447.0, 411110.0, 410987.0, 411008.0, 410489.0, 410749.0, 410250.0, 411319.0, 409790.0, 410792.0, 409742.0, 411152.0, 409638.0, 411428.0, 409569.0, 410837.0, 409653.0, 411435.0, 409668.0, 411089.0, 409798.0, 410961.0, 409931.0, 410889.0, 410027.0, 410784.0, 410514.0, 410674.0, 410716.0, 410476.0, 410812.0, 410541.0, 411574.0, 410330.0, 411304.0, 410516.0, 412083.0, 410537.0, 412456.0, 410735.0, 412029.0, 410952.0, 412907.0, 410935.0, 412480.0, 411300.0, 412067.0, 411372.0, 412429.0, 411497.0, 412288.0, 412001.0, 412259.0, 412173.0, 412106.0, 412451.0, 412071.0, 413155.0, 411911.0, 412800.0, 412101.0, 413681.0, 412034.0, 413831.0, 412266.0, 413818.0, 412390.0, 414261.0, 412395.0, 413785.0, 412403.0, 413528.0, 412128.0, 412751.0, 411170.0, 411373.0, 410257.0, 409674.0, 408806.0, 407938.0, 407426.0, 406298.0, 406432.0, 404712.0, 404888.0, 403671.0, 404670.0, 402589.0, 403854.0, 402110.0, 403151.0, 401793.0, 403503.0, 401592.0, 402926.0, 401627.0, 402894.0, 401664.0, 402766.0, 401774.0, 402754.0, 402403.0, 402815.0, 402763.0, 402878.0, 403193.0, 403077.0, 403925.0, 403173.0, 403844.0, 403395.0, 405033.0, 403563.0, 405162.0, 403901.0, 405407.0, 404353.0, 406403.0, 404651.0, 406250.0, 405253.0, 406608.0, 405417.0, 406757.0, 405816.0, 406823.0, 406339.0, 406939.0, 406645.0, 406841.0, 406973.0, 406729.0, 407383.0, 406387.0, 407001.0, 406332.0, 407759.0, 405939.0, 407254.0, 405858.0, 407067.0, 405678.0, 407534.0, 405553.0, 406847.0, 405527.0, 406788.0, 405346.0, 406432.0, 405141.0, 406117.0, 405366.0, 405797.0, 405261.0, 405560.0, 405550.0, 405349.0, 405895.0, 405110.0, 405664.0, 405188.0, 406673.0, 405034.0, 406409.0, 405266.0, 406654.0, 405376.0, 407330.0, 405522.0, 406916.0, 405760.0, 407316.0, 405817.0, 407185.0, 406071.0, 407128.0, 406528.0, 407102.0, 406483.0, 407046.0, 406988.0, 406831.0, 407446.0, 406748.0, 407326.0, 406728.0, 408314.0, 406743.0, 407931.0, 406858.0, 408228.0, 407004.0, 409079.0, 407248.0, 408616.0, 407507.0, 409098.0, 407575.0, 408962.0, 407804.0, 408891.0, 408205.0, 408882.0, 408250.0, 408709.0, 410697.0, 408660.0, 409123.0, 408566.0, 409124.0, 408560.0, 409967.0, 408334.0, 409506.0, 408326.0, 409504.0, 407729.0, 409253.0, 406674.0, 407205.0, 405379.0, 406187.0, 403798.0, 404503.0, 402513.0, 402958.0, 401443.0, 401620.0, 400287.0, 400426.0, 399954.0, 399499.0, 399549.0, 398803.0, 399121.0, 398476.0, 399570.0, 398146.0, 399127.0, 398201.0, 399562.0, 398332.0, 400367.0, 398666.0, 399907.0, 399018.0, 400710.0, 399206.0, 400692.0, 399625.0, 400857.0, 400151.0, 401184.0, 400385.0, 401297.0, 401277.0, 401422.0, 401815.0, 401507.0, 402032.0, 401692.0, 403029.0, 401768.0, 402934.0, 402169.0, 403865.0, 402506.0, 404665.0, 402993.0, 404385.0, 403351.0, 405193.0, 403486.0, 405000.0, 403805.0, 404939.0, 403881.0, 404767.0, 403789.0, 404497.0, 404082.0, 404083.0, 404066.0, 403672.0, 403974.0, 403421.0, 404465.0, 402983.0, 403774.0, 402871.0, 404304.0, 402701.0, 404435.0, 402748.0, 403828.0, 402722.0, 404569.0, 402765.0, 404181.0, 402922.0, 404116.0, 403041.0, 404102.0, 403152.0, 403928.0, 403758.0, 403948.0, 403870.0, 403784.0, 404174.0, 403884.0, 404898.0, 403669.0, 404637.0, 403950.0, 405565.0, 403982.0, 405755.0, 404292.0, 405595.0, 404570.0, 406467.0, 404825.0, 406343.0, 405124.0, 406336.0, 405205.0, 406392.0, 405320.0, 406262.0, 405850.0, 406066.0, 405932.0, 405930.0, 406260.0, 405925.0, 406830.0, 405800.0, 406622.0, 405921.0, 407454.0, 405956.0, 407498.0, 406125.0, 407480.0, 406390.0, 408395.0, 406596.0, 408110.0, 406923.0, 408193.0, 407023.0, 408179.0, 407104.0, 408166.0, 407675.0, 408019.0, 407745.0, 407801.0, 407999.0, 407750.0, 408383.0, 407184.0, 407449.0, 406447.0, 407365.0, 404957.0, 405719.0, 403712.0, 404220.0, 402277.0, 403440.0, 400865.0, 401632.0, 399897.0, 400567.0, 398817.0, 399601.0, 398129.0, 398853.0, 397965.0, 398250.0, 397678.0, 397904.0, 397905.0, 397679.0, 398414.0, 397576.0, 398087.0, 397735.0, 399302.0, 397737.0, 399288.0, 398303.0, 399750.0, 398676.0, 400830.0, 399018.0, 400563.0, 399709.0, 401215.0, 399951.0, 401376.0, 400415.0, 401545.0, 401117.0, 401741.0, 401360.0, 401825.0, 402102.0, 402109.0, 402737.0, 402133.0, 402798.0, 402441.0, 404005.0, 402465.0, 403858.0, 402838.0, 404174.0, 403012.0, 405065.0, 403080.0, 404578.0, 403261.0, 404758.0, 403081.0, 404381.0, 403103.0, 404008.0, 403126.0, 403656.0, 402945.0, 403372.0, 403211.0, 402934.0, 403315.0, 402511.0, 403049.0, 402485.0, 403859.0, 402121.0, 403247.0, 402191.0, 403502.0, 402244.0, 404247.0, 402277.0, 403632.0, 402496.0, 404259.0, 402669.0, 403945.0, 402834.0, 404011.0, 403296.0, 403967.0, 403296.0, 403918.0, 403861.0, 403899.0, 404306.0, 403842.0, 404444.0, 403955.0, 405378.0, 403948.0, 405014.0, 404201.0, 405649.0, 404293.0, 406374.0, 404574.0, 405863.0, 404609.0, 406019.0, 404124.0, 405405.0, 404289.0, 405405.0, 404596.0, 405395.0, 404681.0, 405417.0, 405360.0, 405415.0, 405679.0, 405329.0, 405803.0, 405400.0, 406694.0, 405311.0, 406373.0, 405529.0, 406964.0, 405603.0, 407677.0, 405918.0, 407157.0, 406077.0, 407888.0, 406233.0, 407683.0, 406523.0, 407635.0, 406593.0, 407452.0, 406633.0, 407428.0, 407173.0, 407244.0, 407323.0, 407047.0, 407205.0, 406369.0, 406999.0, 404992.0, 405333.0, 403710.0, 404588.0, 402442.0, 403588.0, 401087.0, 401755.0, 400159.0, 401367.0, 399187.0, 400112.0, 398549.0, 399446.0, 398124.0, 398908.0, 397766.0, 398532.0, 398142.0, 398367.0, 398322.0, 398202.0, 398635.0, 398268.0, 399460.0, 398375.0, 399309.0, 398749.0, 400435.0, 399100.0, 401033.0, 399654.0, 400970.0, 400162.0, 402110.0, 400497.0, 402131.0, 401129.0, 402487.0, 401510.0, 402793.0, 402017.0, 403071.0, 402945.0, 403270.0, 403301.0, 403446.0, 403885.0, 403658.0, 404777.0, 403675.0, 404550.0, 404116.0, 405632.0, 404104.0, 405794.0, 404382.0, 405568.0, 404455.0, 406303.0, 404211.0, 405542.0, 404256.0, 405249.0, 403922.0, 404899.0, 403730.0, 404504.0, 403994.0, 404214.0, 403720.0, 403739.0, 403839.0, 403493.0, 404267.0, 403184.0, 403694.0, 403007.0, 404620.0, 402945.0, 404380.0, 403053.0, 404343.0, 403201.0, 405149.0, 403314.0, 404714.0, 403669.0, 404954.0, 403687.0, 404943.0, 403816.0, 404835.0, 404357.0, 404871.0, 404542.0, 404863.0, 404983.0, 404719.0, 405523.0, 404668.0, 405354.0, 404811.0, 406465.0, 404907.0, 406374.0, 405161.0, 406526.0, 405388.0, 407370.0, 405587.0, 407096.0, 405879.0, 407312.0, 405965.0, 407201.0, 406151.0, 407134.0, 406642.0, 407151.0, 406703.0, 407122.0, 407292.0, 407039.0, 407635.0, 406895.0, 407367.0, 406757.0, 408092.0, 406251.0, 407337.0, 406220.0, 407685.0, 406453.0, 408526.0, 406711.0, 408078.0, 407056.0, 408683.0, 407308.0, 408607.0, 407498.0, 408587.0, 407834.0, 408510.0, 407887.0, 408272.0, 408014.0, 407443.0, 407433.0, 406097.0, 405897.0, 404590.0, 405296.0, 402962.0, 403451.0, 401767.0, 402497.0, 400547.0, 402002.0, 399645.0, 400520.0, 399002.0, 400231.0, 398509.0, 399582.0, 398308.0, 399263.0, 398459.0, 399213.0, 398501.0, 399136.0, 399172.0, 399239.0, 399609.0, 399284.0, 399859.0, 399502.0, 401095.0, 399696.0, 400948.0, 400120.0, 401646.0, 400527.0, 402639.0, 400861.0, 402356.0, 401397.0, 403236.0, 401788.0, 403285.0, 402189.0, 403411.0, 402774.0, 403774.0, 403133.0, 403982.0, 404082.0, 404125.0, 404513.0, 404260.0, 404806.0, 404410.0, 405814.0, 404399.0, 405556.0, 404768.0, 406120.0, 404688.0, 406624.0, 404728.0, 405864.0, 404771.0, 406349.0, 404527.0, 405769.0, 404464.0, 405453.0, 404416.0, 405095.0, 404202.0, 404696.0, 404448.0, 404370.0, 404432.0, 404010.0, 404357.0, 403842.0, 405053.0, 403500.0, 404481.0, 403646.0, 405093.0, 403659.0, 405546.0, 403774.0, 405066.0, 403988.0, 405740.0, 404076.0, 405568.0, 404357.0, 405488.0, 404574.0, 405624.0, 404695.0, 405511.0, 405452.0, 405565.0, 405668.0, 405544.0, 405870.0, 405612.0, 406682.0, 405439.0, 406375.0, 405698.0, 407249.0, 405724.0, 407542.0, 405991.0, 407186.0, 406171.0, 407987.0, 406272.0, 407679.0, 406515.0, 407700.0, 406658.0, 407711.0, 406841.0, 407698.0, 407408.0, 407677.0, 407647.0, 407588.0, 407928.0, 407558.0, 408601.0, 407482.0, 408276.0, 407666.0, 409184.0, 407669.0, 409374.0, 407880.0, 409184.0, 408081.0, 410006.0, 408231.0, 409678.0, 408588.0, 409716.0, 408542.0, 409687.0, 408512.0, 409175.0, 408376.0, 408112.0, 407089.0, 406397.0, 405917.0, 404835.0, 405001.0, 403272.0, 403284.0, 402115.0, 403072.0, 400852.0, 401848.0, 400087.0, 400953.0, 399495.0, 401145.0, 399113.0, 400420.0, 399134.0, 400354.0, 399040.0, 400229.0, 399157.0, 400223.0, 399813.0, 400267.0, 400067.0, 400349.0, 400656.0, 400443.0, 401358.0, 400591.0, 401316.0, 400963.0, 402723.0, 401183.0, 402841.0, 401751.0, 403189.0, 402193.0, 404305.0, 402588.0, 404242.0, 403211.0, 404630.0, 403463.0, 404848.0, 403903.0, 405079.0, 404724.0, 405321.0, 405024.0, 405434.0, 405734.0, 405594.0, 406352.0, 405643.0, 406226.0, 405803.0, 407298.0, 405560.0, 406742.0, 405579.0, 406789.0, 405457.0, 407343.0, 405305.0, 406575.0, 405295.0, 406514.0, 404973.0, 406015.0, 404825.0, 405703.0, 404921.0, 405310.0, 404725.0, 404995.0, 404988.0, 404744.0, 405147.0, 404411.0, 404844.0, 404393.0, 405925.0, 404252.0, 405406.0, 404415.0, 405729.0, 404499.0, 406476.0, 404588.0, 405984.0, 404987.0, 406433.0, 404895.0, 406293.0, 405196.0, 406360.0, 405687.0, 406256.0, 405690.0, 406270.0, 406326.0, 406263.0, 406742.0, 406191.0, 406663.0, 406243.0, 407759.0, 406204.0, 407406.0, 406409.0, 407829.0, 406685.0, 408667.0, 406705.0, 408078.0, 407119.0, 408663.0, 407044.0, 408396.0, 407364.0, 408459.0, 407654.0, 408466.0, 407738.0, 408341.0, 408321.0, 408287.0, 408646.0, 408229.0, 408637.0, 408320.0, 409682.0, 408095.0, 409168.0, 408378.0, 409727.0, 408419.0, 410342.0, 408537.0, 409775.0, 408725.0, 410377.0, 408673.0, 409975.0, 408477.0, 409181.0, 407739.0, 407713.0, 406226.0, 406069.0, 405147.0, 404370.0, 403874.0, 402825.0, 402531.0, 401439.0, 402194.0, 400198.0, 400720.0, 399572.0, 400681.0, 399020.0, 400767.0, 398741.0, 399893.0, 398804.0, 400465.0, 398643.0, 400073.0, 398894.0, 400031.0, 399143.0, 400132.0, 399483.0, 400337.0, 400215.0, 400439.0, 400747.0, 400591.0, 401202.0, 400795.0, 402308.0, 401073.0, 402220.0, 401582.0, 403250.0, 401823.0, 403901.0, 402318.0, 403786.0, 402858.0, 404825.0, 403221.0, 404918.0, 403891.0, 405168.0, 404217.0, 405329.0, 404502.0, 405468.0, 405256.0, 405477.0, 405574.0, 405441.0, 406002.0, 405475.0, 406573.0, 405254.0, 405993.0, 405182.0, 406610.0, 404873.0, 406560.0, 404833.0, 406029.0, 404710.0, 406428.0, 404577.0, 405813.0, 404500.0, 405572.0, 404379.0, 405215.0, 404199.0, 405030.0, 404634.0, 404719.0, 404554.0, 404451.0, 404714.0, 404334.0, 405229.0, 404116.0, 404861.0, 404297.0, 405845.0, 404185.0, 405868.0, 404450.0, 405762.0, 404717.0, 406998.0, 404937.0, 406407.0, 405291.0, 406476.0, 405323.0, 406202.0, 405486.0, 406401.0, 406084.0, 406405.0, 406213.0, 406284.0, 406584.0, 406174.0, 407134.0, 406043.0, 406895.0, 406255.0, 407853.0, 406208.0, 407736.0, 406462.0, 407770.0, 406686.0, 408654.0, 406901.0, 408427.0, 407368.0, 408537.0, 407361.0, 408630.0, 407639.0, 408719.0, 408200.0, 408673.0, 408330.0, 408623.0, 408812.0, 408623.0, 409551.0, 408462.0, 409149.0, 408586.0, 410302.0, 408627.0, 410073.0, 408784.0, 410218.0, 408964.0, 410770.0, 408492.0, 409399.0, 407573.0, 408009.0, 405885.0, 406296.0, 404514.0, 404745.0, 403437.0, 403337.0, 402296.0, 402075.0, 401702.0, 401039.0, 401287.0, 400165.0, 400417.0, 399709.0, 401099.0, 399366.0, 400570.0, 399399.0, 400718.0, 399508.0, 401576.0, 399791.0, 401216.0, 400282.0, 401804.0, 400472.0, 401871.0, 400953.0, 402170.0, 401664.0, 402425.0, 402008.0, 402629.0, 402876.0, 402879.0, 403552.0, 403008.0, 403674.0, 403414.0, 405102.0, 403687.0};
volatile uint16_t read = 0;
#define TAP_NUM_BRUIT 31
#define TAP_NUM_DC 301
#define BLOCK_SIZE 2000

const float32_t FIR6[TAP_NUM_BRUIT] = {0.0019164436f, 0.0025723536f, 0.0039746290f, 0.0063381812f, 0.0098062778f, 0.0144284967f, 0.0201469907f, 0.0267928419f, 0.0340932845f, 0.0416894674f, 0.0491633283f, 0.0560711793f, 0.0619808685f, 0.0665089593f, 0.0693543124f, 0.0703247711f, 0.0693543124f, 0.0665089593f, 0.0619808685f, 0.0560711793f, 0.0491633283f, 0.0416894674f, 0.0340932845f, 0.0267928419f, 0.0201469907f, 0.0144284967f, 0.0098062778f, 0.0063381812f, 0.0039746290f, 0.0025723536f, 0.0019164436f};
const float32_t FIR1_HIGH[TAP_NUM_DC]= {
0.0000997754f, 0.0000970613f, 0.0000944769f, 0.0000919989f, 0.0000896025f, 0.0000872614f, 0.0000849479f, 0.0000826327f, 0.0000802853f, 0.0000778736f, 0.0000753645f, 0.0000727233f, 0.0000699143f, 0.0000669005f, 0.0000636439f, 0.0000601054f, 0.0000562450f, 0.0000520216f, 0.0000473934f, 0.0000423178f, 0.0000367514f, 0.0000306502f, 0.0000239697f, 0.0000166648f, 0.0000086902f, 0.0000000000f, -0.0000094518f, -0.0000197112f, -0.0000308246f, -0.0000428382f, -0.0000557979f, -0.0000697499f, -0.0000847396f, -0.0001008123f, -0.0001180129f, -0.0001363854f, -0.0001559736f, -0.0001768202f, -0.0001989673f, -0.0002224560f, -0.0002473263f, -0.0002736173f, -0.0003013667f, -0.0003306111f, -0.0003613857f, -0.0003937242f, -0.0004276588f, -0.0004632201f, -0.0005004370f, -0.0005393368f, -0.0005799447f, -0.0006222841f, -0.0006663765f, -0.0007122413f, -0.0007598957f, -0.0008093549f, -0.0008606316f, -0.0009137365f, -0.0009686778f, -0.0010254613f, -0.0010840905f, -0.0011445661f, -0.0012068867f, -0.0012710480f, -0.0013370432f, -0.0014048630f, -0.0014744954f, -0.0015459256f, -0.0016191364f, -0.0016941075f, -0.0017708164f, -0.0018492374f, -0.0019293426f, -0.0020111009f, -0.0020944790f, -0.0021794405f, -0.0022659466f, -0.0023539558f, -0.0024434239f, -0.0025343045f, -0.0026265480f, -0.0027201030f, -0.0028149152f, -0.0029109279f, -0.0030080824f, -0.0031063172f, -0.0032055689f, -0.0033057719f, -0.0034068583f, -0.0035087583f, -0.0036114001f, -0.0037147100f, -0.0038186126f, -0.0039230306f, -0.0040278851f, -0.0041330958f, -0.0042385807f, -0.0043442567f, -0.0044500394f, -0.0045558430f, -0.0046615810f, -0.0047671657f, -0.0048725086f, -0.0049775206f, -0.0050821120f, -0.0051861923f, -0.0052896710f, -0.0053924570f, -0.0054944594f, -0.0055955869f, -0.0056957485f, -0.0057948533f, -0.0058928109f, -0.0059895311f, -0.0060849244f, -0.0061789020f, -0.0062713757f, -0.0063622585f, -0.0064514643f, -0.0065389080f, -0.0066245060f, -0.0067081759f, -0.0067898369f, -0.0068694098f, -0.0069468170f, -0.0070219828f, -0.0070948333f, -0.0071652969f, -0.0072333037f, -0.0072987863f, -0.0073616796f, -0.0074219207f, -0.0074794495f, -0.0075342081f, -0.0075861414f, -0.0076351972f, -0.0076813258f, -0.0077244806f, -0.0077646178f, -0.0078016966f, -0.0078356793f, -0.0078665312f, -0.0078942209f, -0.0079187200f, -0.0079400036f, -0.0079580499f, -0.0079728403f, -0.0079843597f, -0.0079925963f, -0.0079975416f, 0.9918996416f, -0.0079975416f, -0.0079925963f, -0.0079843597f, -0.0079728403f, -0.0079580499f, -0.0079400036f, -0.0079187200f, -0.0078942209f, -0.0078665312f, -0.0078356793f, -0.0078016966f, -0.0077646178f, -0.0077244806f, -0.0076813258f, -0.0076351972f, -0.0075861414f, -0.0075342081f, -0.0074794495f, -0.0074219207f, -0.0073616796f, -0.0072987863f, -0.0072333037f, -0.0071652969f, -0.0070948333f, -0.0070219828f, -0.0069468170f, -0.0068694098f, -0.0067898369f, -0.0067081759f, -0.0066245060f, -0.0065389080f, -0.0064514643f, -0.0063622585f, -0.0062713757f, -0.0061789020f, -0.0060849244f, -0.0059895311f, -0.0058928109f, -0.0057948533f, -0.0056957485f, -0.0055955869f, -0.0054944594f, -0.0053924570f, -0.0052896710f, -0.0051861923f, -0.0050821120f, -0.0049775206f, -0.0048725086f, -0.0047671657f, -0.0046615810f, -0.0045558430f, -0.0044500394f, -0.0043442567f, -0.0042385807f, -0.0041330958f, -0.0040278851f, -0.0039230306f, -0.0038186126f, -0.0037147100f, -0.0036114001f, -0.0035087583f, -0.0034068583f, -0.0033057719f, -0.0032055689f, -0.0031063172f, -0.0030080824f, -0.0029109279f, -0.0028149152f, -0.0027201030f, -0.0026265480f, -0.0025343045f, -0.0024434239f, -0.0023539558f, -0.0022659466f, -0.0021794405f, -0.0020944790f, -0.0020111009f, -0.0019293426f, -0.0018492374f, -0.0017708164f, -0.0016941075f, -0.0016191364f, -0.0015459256f, -0.0014744954f, -0.0014048630f, -0.0013370432f, -0.0012710480f, -0.0012068867f, -0.0011445661f, -0.0010840905f, -0.0010254613f, -0.0009686778f, -0.0009137365f, -0.0008606316f, -0.0008093549f, -0.0007598957f, -0.0007122413f, -0.0006663765f, -0.0006222841f, -0.0005799447f, -0.0005393368f, -0.0005004370f, -0.0004632201f, -0.0004276588f, -0.0003937242f, -0.0003613857f, -0.0003306111f, -0.0003013667f, -0.0002736173f, -0.0002473263f, -0.0002224560f, -0.0001989673f, -0.0001768202f, -0.0001559736f, -0.0001363854f, -0.0001180129f, -0.0001008123f, -0.0000847396f, -0.0000697499f, -0.0000557979f, -0.0000428382f, -0.0000308246f, -0.0000197112f, -0.0000094518f, 0.0000000000f, 0.0000086902f, 0.0000166648f, 0.0000239697f, 0.0000306502f, 0.0000367514f, 0.0000423178f, 0.0000473934f, 0.0000520216f, 0.0000562450f, 0.0000601054f, 0.0000636439f, 0.0000669005f, 0.0000699143f, 0.0000727233f, 0.0000753645f, 0.0000778736f, 0.0000802853f, 0.0000826327f, 0.0000849479f, 0.0000872614f, 0.0000896025f, 0.0000919989f, 0.0000944769f, 0.0000970613f, 0.0000997754f};
const float32_t FIR1_LOW[TAP_NUM_BRUIT] = {0.0048171958f, 0.0054392119f, 0.0072548913f, 0.0101944495f, 0.0141369702f, 0.0189156209f, 0.0243249902f, 0.0301302208f, 0.0360775225f, 0.0419055883f, 0.0473573888f, 0.0521918051f, 0.0561945634f, 0.0591879674f, 0.0610389786f, 0.0616652707f, 0.0610389786f, 0.0591879674f, 0.0561945634f, 0.0521918051f, 0.0473573888f, 0.0419055883f, 0.0360775225f, 0.0301302208f, 0.0243249902f, 0.0189156209f, 0.0141369702f, 0.0101944495f, 0.0072548913f, 0.0054392119f, 0.0048171958f};

const uint32_t blockSize = BLOCK_SIZE;
const uint32_t numBlocks = 1;
static float32_t buff_filtered_IR[BLOCK_SIZE];
static float32_t buff_filtered_IR_DC[BLOCK_SIZE];
static float32_t buff_filtered_RED[BLOCK_SIZE];
static float32_t buff_filtered_RED_DC[BLOCK_SIZE];

static float32_t firStateHigh[BLOCK_SIZE + TAP_NUM_DC - 1];
static float32_t firStatelow[BLOCK_SIZE + TAP_NUM_BRUIT -1];
static float32_t firStateDC[BLOCK_SIZE + TAP_NUM_BRUIT -1];


void Traitement(void)
{
  
  arm_fir_instance_f32 S_IR, S_IR_DC, S_RED, S_RED_DC;
  arm_status status;
  float32_t  *input_IR, *output_signal_IR, *output_IR_DC, *input_RED, *output_signal_RED, *output_RED_DC;
  volatile int BPM = 0;
  volatile int nb_peak_max = 0;
  int nb_peak_min = 0;
  
  
  /* Initialize input and output buffer pointers */
  input_IR = &vecteur_IR[read];
  output_signal_IR = &buff_filtered_IR[0];
  output_IR_DC = &buff_filtered_IR_DC[0];

  input_RED = &vecteur_RED[read];
  output_signal_RED = &buff_filtered_RED[0];
  output_RED_DC = &buff_filtered_RED_DC[0];
  /* Call FIR init function to initialize the instance structure. */
  arm_fir_init_f32(&S_IR, TAP_NUM_DC, (float32_t *)&FIR1_HIGH[0], &firStateHigh[0], blockSize);
  arm_fir_f32(&S_IR, input_IR, output_signal_IR, blockSize);
  arm_fir_init_f32(&S_RED, TAP_NUM_DC, (float32_t *)&FIR1_HIGH[0], &firStateHigh[0], blockSize);
  arm_fir_f32(&S_RED, input_RED, output_signal_RED, blockSize);

  arm_fir_init_f32(&S_IR, TAP_NUM_BRUIT, (float32_t *)&FIR6[0], &firStatelow[0], blockSize);
  arm_fir_f32(&S_IR, output_signal_IR, output_signal_IR, blockSize);
  arm_fir_init_f32(&S_RED, TAP_NUM_BRUIT, (float32_t *)&FIR6[0], &firStatelow[0], blockSize);
  arm_fir_f32(&S_RED, output_signal_RED, output_signal_RED, blockSize);

  input_IR = &vecteur_IR[0];
  input_RED = &vecteur_RED[0];
  arm_fir_init_f32(&S_IR_DC, TAP_NUM_BRUIT, (float32_t *)&FIR1_LOW[0], &firStateDC[0], blockSize);
  arm_fir_f32(&S_IR_DC, input_IR, output_IR_DC, blockSize);
  arm_fir_init_f32(&S_RED_DC, TAP_NUM_BRUIT, (float32_t *)&FIR1_LOW[0], &firStateDC[0], blockSize);
  arm_fir_f32(&S_RED_DC, input_RED, output_RED_DC, blockSize);


//BPM et SpO2
  volatile float64_t AC_IR = 0;
  volatile float64_t DC_IR = 0;
  volatile float64_t AC_RED = 0;
  volatile float64_t DC_RED = 0;
  volatile float64_t R = 0;
  float last_max_peak_IR = 0;
  float last_min_peak_IR = 0;
  float last_max_peak_RED = 0;
  float last_min_peak_RED = 0;
  int pos_dernier_max_pic_IR = 1000;
  int pos_dernier_min_pic_IR = 1000;
  int pos_dernier_max_pic_RED = 1000;
  int pos_dernier_min_pic_RED = 1000;
  float moyenne_max_IR = 0;
  float moyenne_min_IR = 0;
  float moyenne_max_RED = 0;
  float moyenne_min_RED = 0;

  for(int i =400; i<1650; i++){
    bool v1 = buff_filtered_IR[i] > buff_filtered_IR[i-1];
    bool v2 = buff_filtered_IR[i] > buff_filtered_IR[i-2];
    bool v3 = buff_filtered_IR[i] > buff_filtered_IR[i-3];
    bool v4 = buff_filtered_IR[i] > buff_filtered_IR[i-4];
    bool v5 = buff_filtered_IR[i] > buff_filtered_IR[i-5];
    bool v6 = buff_filtered_IR[i] > buff_filtered_IR[i+1];
    bool v7 = buff_filtered_IR[i] > buff_filtered_IR[i+2];
    bool v8 = buff_filtered_IR[i] > buff_filtered_IR[i+3];
    bool v9 = buff_filtered_IR[i] > buff_filtered_IR[i+4];
    bool v10 = buff_filtered_IR[i] > buff_filtered_IR[i+5];
    bool r1 = buff_filtered_RED[i] > buff_filtered_RED[i-1];
    bool r2 = buff_filtered_RED[i] > buff_filtered_RED[i-2];
    bool r3 = buff_filtered_RED[i] > buff_filtered_RED[i-3];
    bool r4 = buff_filtered_RED[i] > buff_filtered_RED[i-4];
    bool r5 = buff_filtered_RED[i] > buff_filtered_RED[i-5];
    bool r6 = buff_filtered_RED[i] > buff_filtered_RED[i+1];
    bool r7 = buff_filtered_RED[i] > buff_filtered_RED[i+2];
    bool r8 = buff_filtered_RED[i] > buff_filtered_RED[i+3];
    bool r9 = buff_filtered_RED[i] > buff_filtered_RED[i+4];
    bool r10 = buff_filtered_RED[i] > buff_filtered_RED[i+5];
    bool keep_max_IR = pos_dernier_max_pic_IR > 100;
    bool keep_min_IR = pos_dernier_min_pic_IR > 100;
    bool keep_max_RED = pos_dernier_max_pic_RED > 100;
    bool keep_min_RED = pos_dernier_min_pic_RED > 100;
    pos_dernier_max_pic_IR++;
    pos_dernier_min_pic_IR++;
    pos_dernier_max_pic_RED++;
    pos_dernier_min_pic_RED++;
    DC_IR += buff_filtered_IR_DC[i]/1250;
    DC_RED += buff_filtered_RED_DC[i]/1250;
    
    if(v1 & v2 & v3 & v4 & v5 & v6 & v7 & v8 & v9 & v10){
        if(keep_max_IR){
        pos_dernier_max_pic_IR = 0;
        nb_peak_max += 1;
        last_max_peak_IR = buff_filtered_IR[i];
        moyenne_max_IR += last_max_peak_IR;
        }
        if(buff_filtered_IR[i] > last_max_peak_IR + 1000){
            pos_dernier_max_pic_IR = 0;
            AC_IR -= last_max_peak_IR + buff_filtered_IR[i];
            last_max_peak_IR = buff_filtered_IR[i];
        }
    }
    else if (!v1 & !v2 & !v3 & !v4 & !v5& !v6 & !v7 & !v8 & !v9 & !v10 & keep_min_IR){
        nb_peak_min += 1;
        moyenne_min_IR += buff_filtered_IR[i]; 
        last_min_peak_IR = buff_filtered_IR[i];
        pos_dernier_min_pic_IR = 0;
    }   
    
    if(r1 & r2 & r3 & r4 & r5 & r6 & r7 & r8 & r9 & r10){
        if(keep_max_RED){
        pos_dernier_max_pic_RED = 0;
        last_max_peak_RED = buff_filtered_RED[i];
        moyenne_max_RED += last_max_peak_RED;
        }
        if(buff_filtered_RED[i] > last_max_peak_RED + 1000){
            pos_dernier_max_pic_RED = 0;
            AC_RED -= last_max_peak_RED + buff_filtered_RED[i];
            last_max_peak_RED = buff_filtered_RED[i];
        }
    }
    else if (!r1 & !r2 & !r3 & !r4 & !r5& !r6 & !r7 & !r8 & !r9 & !r10 & keep_min_RED){
        moyenne_min_RED += buff_filtered_RED[i]; 
        last_min_peak_RED = buff_filtered_RED[i];
        pos_dernier_min_pic_RED = 0;
    }   
}
    
  moyenne_max_IR = moyenne_max_IR/nb_peak_max;
  moyenne_min_IR = moyenne_min_IR/nb_peak_min;
  moyenne_max_RED = moyenne_max_RED/nb_peak_max;
  moyenne_min_RED = moyenne_min_RED/nb_peak_min;
  BPM = nb_peak_max*6;
  AC_IR = moyenne_max_IR - moyenne_min_IR;
  AC_RED = moyenne_max_RED - moyenne_min_RED;
  R = (AC_RED/DC_RED)/(AC_IR/DC_IR);
  
}